<!DOCTYPE html>
<html>
  <head>
   <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <a href="/<%= session["story"].first.storyline %>">Back to the start</a>
    <a href="/back">Up one level</a>
    <a href="/trail">Tell me a story</a>
      <div class="wrapper">
        <% 1.upto(9) do  |i| %>
          <% if i%2==1 && i!=5 %>
             <div class="empty box"></div>
          <% elsif i==5 %>
            <div id="centre" class="box">
              <%= session["startline"].storyline %>
            </div>
          <% else %> 
            <% if i==2 %>
              <div class="box">
                <% @line_exists = session["currentpage"].detect { |l| l.position == "a"} %>
                  <% if @line_exists %>
                    <a href="/<%= @line_exists.storyline %>"><%= @line_exists.storyline %></a>
                  <% else %>
                    <form action="newline" method="POST">
                      <input type="text" name="line"/>
                      <input type="hidden" name="pos" value="a"/>
                      <input type="submit"/>
                    </form>
                  <% end %>
              </div> 
            <% elsif i==4 %>
              <div class="box">
                 <% @line_exists = session["currentpage"].detect { |l| l.position == "b"} %>
                  <% if @line_exists %>
                    <a href="/<%= @line_exists.storyline %>"><%= @line_exists.storyline %></a>
                  <% else %>
                    <form action="newline" method="POST">
                      <input type="text" name="line"/>
                      <input type="hidden" name="pos" value="b"/>
                      <input type="submit"/>
                    </form>
                  <% end %>
              </div>  
            <% elsif i==6 %>
              <div class="box">
                <% @line_exists = session["currentpage"].detect { |l| l.position == "c"} %>
                  <% if @line_exists %>
                    <a href="/<%= @line_exists.storyline %>"><%= @line_exists.storyline %></a>
                  <% else %>
                    <form action="newline" method="POST">
                      <input type="text" name="line"/>
                      <input type="hidden" name="pos" value="c"/>
                      <input type="submit"/>
                    </form>
                  <% end %>
              </div>  
            <% elsif i==8 %>
              <div class="box">
                 <% @line_exists = session["currentpage"].detect { |l| l.position == "d"} %>
                  <% if @line_exists %>
                    <a href="/<%= @line_exists.storyline %>"><%= @line_exists.storyline %></a>
                  <% else %>
                    <form action="newline" method="POST">
                      <input type="text" name="line"/>
                      <input type="hidden" name="pos" value="d"/>
                      <input type="submit"/>
                    </form>
                 <% end %>  
              </div>  
            <% end %>    
          <% end %>
        <% end %>
      </div>
      <div id="storytrail">
          <% if @storytrail %>
            <p><%= @storytrail %></p>
          <% end %>
      </div>
    </body>
  </html>
  
